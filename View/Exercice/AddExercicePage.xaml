<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="GymProgress.Mobile.AddExercicePage"
             Title="Ajouter un Exercice">
    <Shell.TitleView>
        <Grid>
            <Label Text="{Binding CurrentSeance.Name}"
                   Padding="0,18,70,0"
                   Grid.Column="0">
            </Label>
            <Button Grid.Column="1" 
                    Text="{Binding ButtonCreateExerciceText}" 
                    Command="{Binding ButtonCreateExerciceCommand}"
                    WidthRequest="100" 
                    HeightRequest="40" 
                    HorizontalOptions="End" 
                    Margin="0, 0, 20, 0" />
        </Grid>
    </Shell.TitleView>
    <ContentPage.Resources>
        <ResourceDictionary>
            <toolkit:InvertedBoolConverter x:Key="InvertedBoolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>
    <Grid>
        <StackLayout IsVisible="{Binding IsLoaded}">
            <Grid IsVisible="{Binding DisponibleExercice}">
                <CollectionView ItemsSource="{Binding Exercices}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <HorizontalStackLayout Margin="20, 5, 0, 0">
                                    <CheckBox IsChecked="{Binding IsSelected}" />
                                    <Label Text="{Binding Nom}"
                           FontSize="16"
                           Margin="0,10,0,0" />
                                </HorizontalStackLayout>
                            </Grid>

                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Grid>
            <VerticalStackLayout IsVisible="{Binding DisponibleExercice}">
                <Button Grid.Column="1"
                        Text="{Binding ButtonValidExerciceText}"
                        Command="{Binding ButtonValidExerciceCommand}"
                        WidthRequest="100"
                        HeightRequest="40"
                        HorizontalOptions="Center"
                        Margin="0, 20, 20, 0" />
            </VerticalStackLayout>
            <StackLayout IsVisible="{Binding DisponibleExercice, Converter={StaticResource InvertedBoolConverter}}"
                         VerticalOptions="CenterAndExpand">
                <VerticalStackLayout>
                    <Frame Margin="50,5" 
                           Padding="10">
                        <VerticalStackLayout>
                            <Label Text="Tous les exercices disponibles ont déjà été ajoutés à cette séance."
                                   HorizontalTextAlignment="Center" />
                            <Label Text="Vous pouvez en créer un nouveau si vous souhaitez en ajouter un autre."
                                   HorizontalTextAlignment="Center" />
                        </VerticalStackLayout>
                    </Frame>
                </VerticalStackLayout>
            </StackLayout>

        </StackLayout>

        <ActivityIndicator IsRunning="{Binding IsRunning}"
                           IsVisible="{Binding IsRunning}"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"
                           WidthRequest="50"
                           HeightRequest="50" />
    </Grid>
</ContentPage>